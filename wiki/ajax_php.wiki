#labels Phase-Design
= Introduction =

ajax.php interface data exchange format for ajax 

= Details =
*use double quote, not single quote, as php json_decode does so*

== conversation sample ==

=== captcha validation ===
 # data={"action":"captcha"}
 # {"errno":0,"contents":"<img src=\"/static/captcha/3123123.jpg\" />"}
 # Note: only when there is an id "captcha", you will submit this captcha validation request.

=== post a comment ===
 # data={"eid":12321,"msg":"顶","captcha":"A3sC","action":"add"}
 # {"errno":0,"cid":44123}
 * Note: "captcha" is disabled when ($sg_comment_captcha == false).

=== view current comments ===
 # data={"eid":12321,"page",10,"action":"view"}  
 # {"errno":0,"allow_del":"true","contents":{"cid":[100,102,107],"username":["guest1","guest2","guest3"],"msg":["顶1","顶2","顶3"],"date":["2008-11-5 11:08","2008-11-5 11:08","2008-11-5 11:08"],"ip":["127.0.0.1","127.0.0.2","127.0.0.3"]}
 * Note: "allow_del" and "ip" are for administration, and are not required. *Iff* there is "allow_del", there will be a button for sysop to delete comment, the same with "ip".

=== delete a comment ===
 # data={"cid":100,"action":"del",} 
 # {"errno":1}

=== post a rating ===
 # data={"eid":12321,"score":5,"action":"rate"}
 # {"errno":0}

== returned errno ==
 * -1	unknown error
 * 0	success
 * 1	action not implemented
 * 2	invalid request
 * 3	not authorized
 * 4	captcha failure